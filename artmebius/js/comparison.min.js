Comparison={add:{options:{add:".comparison-add",remove:".comparison-remove",go:".comparison-go",total:".comparison-total",added:"added",can_compare:"can_compare",loading:"loading"},initialize:function(n,a){var i,d;$(n).length&&(i=this.options,d=a.minItems||1,$(document).on("click",n+" "+i.add+","+n+" "+i.remove,function(){var t=$(this),e=t.parents(n),a=e.data("list"),s=e.data("id"),o=t.hasClass(i.add.substr(1))?"add":"remove";return t.hasClass(i.loading)||(t.addClass(i.loading),$.post(document.location.href,{cmp_action:o,list:a,resource:s},function(a){t.removeClass(i.loading),a.success?($(i.total,n).text(a.data.total),a.data.link&&$(i.go,n).attr("href",a.data.link),a.data.total>=d?$(n).addClass(i.can_compare):$(n).removeClass(i.can_compare),"add"==o?(e.addClass(i.added),0<a.data.total&&$(".hdr_compare").addClass(i.added)):(e.removeClass(i.added),0==a.data.total&&$(".hdr_compare").removeClass(i.added))):"undefined"!=typeof miniShop2?miniShop2.Message.error(a.message):alert(a.message)},"json")),!1}))}},list:{options:{all:".comparison-params-all",unique:".comparison-params-unique",same_class:"same",active_class:"active"},initialize:function(d,a){if($(d).length){var t,r={};for(t in Comparison.add.options)r[t]=Comparison.add.options[t];for(t in this.options)r[t]=this.options[t];var l=a.minItems||1;$(document).on("click",d+" "+r.all+","+d+" "+r.unique,function(){var a=$(this),t=a.parents(d);return a.hasClass(r.active_class)||(a.hasClass(r.all.substr(1))?($(r.unique,t).removeClass(r.active_class),a.addClass(r.active_class),$("."+r.same_class,t).show()):a.hasClass(r.unique.substr(1))&&($(r.all,t).removeClass(r.active_class),a.addClass(r.active_class),$("."+r.same_class,t).hide())),!1}),$(document).on("click",d+" "+r.remove,function(a){var t=$(this),e=t.parents(d),s=t.data("text"),o=t.parents(".comparison-head").data("list"),n=t.parents(".comparison-head").data("id"),i=$(r.remove,d).index(this)+1;return s.length&&t.attr("data-text",Comparison.utils.encode(t.html())).html(s),$.post(document.location.href,{cmp_action:"remove",list:o,resource:n},function(a){s.length&&(s=Comparison.utils.decode(t.attr("data-text")),t.attr("data-text",Comparison.utils.encode(t.html())).html(s)),t.removeClass(r.loading),a.success?(a.data.total<l&&(document.location=document.location.pathname),$(r.total).text(a.data.total),e.find("tr").each(function(){$(this).find("th:eq("+i+"), td:eq("+i+")").remove()})):"undefined"!=typeof miniShop2?miniShop2.Message.error(a.message):alert(a.message)},"json"),!1})}}},utils:{encode:function(a){return $("<pre/>").text(a).html()},decode:function(a){return $("<pre/>").html(a).text()}}};